### Installation and Usage Instructions
Import and export hdf5 files from Igor. Import these hdf5 files to Python.

Dependencies: SARFIA (Igor procedures), ScanMLoader (Igor procedures), HDF5 XOP (Igor extension), h5py (Python Module)


#### Installing OS scripts

1. Copy all "OS" scripts into your User Procedures in My Documents

2. Open "Igor Procedures/Customstart.ipf" and add the following line: `#include "OS_GUI"`

3. Restart Igor for changes to take effect.


#### Using OS scripts (Igor)

1. Run the function `"OS_GUI()"`. If you have followed the instructions listed above, this should open the GUI in Igor.

2. Execute OS functions by clicking sequentially through the buttons on the GUI

  1. `Load Parameter Table`: Creates table containing the parameters which control subsequent preprocessing scripts

  2. ROI placement can be done with either `Manually` + `Apply` or `Autom. by Correlation`

  3. `Traces & Triggers` then extracts traces and triggers from the raw data

  4. Optional: `Basic Averaging` performs some simple statics and plots the ROIs in Igor

  5. `Export for database` then exports files from your current data folder to the folder specified in the procedure.

    1. It is recommended that you modify the Export for database procedure before using it

    2. Open procedure OS_hdf5Export.ipf

    3. Modify targetPath to match the directory you would like to export the file to

    4. Modify the string at the end of the line `HDF5CreateFile` to the name of the file you export

    5. The waves after HDF5SaveData are then saved inside a HDF5 file at the specified directory

3. The following waves are exported:

  1. OS_Parameters: The parameters generated by the `Load Parameter Table` function

  2. ROIs: The ROI mask used to extract the traces

  3. Traces0_raw: The traces extracted using the ROI mask without normalisation

  4. Traces0_znorm: Traces0_raw but with normalisation

  5. Tracestimes0: ??

  6. Triggertimes: ??

  7. Triggervalues: ??


#### Using Import scripts (Python)

Python Module Dependencies: h5py, numpy, os, pandas, seaborn

Note: These scripts will work in both the iPython server and desktop GUIs, but the directory access will differ. See below.

1. Change the target directory to the location of the file e.g. os.chdir('>directoryName')

2. Execute the function importPreprocessedData. This will return two waves:

  1. importedData: The raw hdf5 data as it was imported into Python

  2. preprocessedData: The data extracted from the hdf5 data, stored in a form usable in the Python environment. Key:values are as follows

    1. OS_Parameters: Pandas DataFrame, with index labels corresponding to the labels in the original Igor Table2

    2. ROIs: Numpy array

    3. Traces0_raw: Pandas DataFrame with indexs as `ROI###`

    4. Traces0_znorm: Pandas DataFrame with indexes as `ROI###`

    5. Tracestimes0: Numpy array

    6. Triggertimes: Numpy array

    7. Triggervalues: Numpy array

Numpy arrays can be used much like matrices in MATLAB.

DataFrame objects are very similiar to arrays, but are structured as tables with column and row labels.

-- For Pandas documentation, see: http://pandas.pydata.org/
